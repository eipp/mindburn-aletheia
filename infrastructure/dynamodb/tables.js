"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createMetricsTable = exports.createResultsTable = exports.createWorkersTable = exports.createTasksTable = void 0;
exports.createVerificationCacheTable = createVerificationCacheTable;
exports.createGoldenSetTable = createGoldenSetTable;
exports.createWorkerActivitiesTable = createWorkerActivitiesTable;
exports.createWorkerMetricsTable = createWorkerMetricsTable;
exports.createConsolidatedResultsTable = createConsolidatedResultsTable;
exports.createInsightsTable = createInsightsTable;
const aws_dynamodb_1 = require("aws-cdk-lib/aws-dynamodb");
const cdk = require("aws-cdk-lib");
const dynamodb = require("aws-cdk-lib/aws-dynamodb");
const createTasksTable = (scope, id) => {
    return new aws_dynamodb_1.Table(scope, id, {
        tableName: 'Tasks',
        partitionKey: { name: 'taskId', type: aws_dynamodb_1.AttributeType.STRING },
        billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
        stream: aws_dynamodb_1.StreamViewType.NEW_AND_OLD_IMAGES,
        timeToLiveAttribute: 'expiresAt',
        // GSIs for efficient querying
        globalSecondaryIndexes: [
            {
                indexName: 'StatusIndex',
                partitionKey: { name: 'status', type: aws_dynamodb_1.AttributeType.STRING },
                sortKey: { name: 'createdAt', type: aws_dynamodb_1.AttributeType.STRING },
                projectionType: aws_dynamodb_1.ProjectionType.ALL,
            },
            {
                indexName: 'TypeIndex',
                partitionKey: { name: 'taskType', type: aws_dynamodb_1.AttributeType.STRING },
                sortKey: { name: 'status', type: aws_dynamodb_1.AttributeType.STRING },
                projectionType: aws_dynamodb_1.ProjectionType.ALL,
            },
        ],
    });
};
exports.createTasksTable = createTasksTable;
const createWorkersTable = (scope, id) => {
    return new aws_dynamodb_1.Table(scope, id, {
        tableName: 'Workers',
        partitionKey: { name: 'workerId', type: aws_dynamodb_1.AttributeType.STRING },
        billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
        globalSecondaryIndexes: [
            {
                indexName: 'StatusIndex',
                partitionKey: { name: 'status', type: aws_dynamodb_1.AttributeType.STRING },
                sortKey: { name: 'lastActive', type: aws_dynamodb_1.AttributeType.STRING },
                projectionType: aws_dynamodb_1.ProjectionType.ALL,
            },
            {
                indexName: 'TaskTypeIndex',
                partitionKey: { name: 'taskType', type: aws_dynamodb_1.AttributeType.STRING },
                sortKey: { name: 'rating', type: aws_dynamodb_1.AttributeType.NUMBER },
                projectionType: aws_dynamodb_1.ProjectionType.ALL,
            },
        ],
    });
};
exports.createWorkersTable = createWorkersTable;
const createResultsTable = (scope, id) => {
    return new aws_dynamodb_1.Table(scope, id, {
        tableName: 'Results',
        partitionKey: { name: 'taskId', type: aws_dynamodb_1.AttributeType.STRING },
        sortKey: { name: 'workerId', type: aws_dynamodb_1.AttributeType.STRING },
        billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
        globalSecondaryIndexes: [
            {
                indexName: 'WorkerIndex',
                partitionKey: { name: 'workerId', type: aws_dynamodb_1.AttributeType.STRING },
                sortKey: { name: 'submittedAt', type: aws_dynamodb_1.AttributeType.STRING },
                projectionType: aws_dynamodb_1.ProjectionType.ALL,
            },
        ],
    });
};
exports.createResultsTable = createResultsTable;
const createMetricsTable = (scope, id) => {
    return new aws_dynamodb_1.Table(scope, id, {
        tableName: 'WorkerMetrics',
        partitionKey: { name: 'workerId', type: aws_dynamodb_1.AttributeType.STRING },
        sortKey: { name: 'metricType', type: aws_dynamodb_1.AttributeType.STRING },
        billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
        globalSecondaryIndexes: [
            {
                indexName: 'MetricTypeIndex',
                partitionKey: { name: 'metricType', type: aws_dynamodb_1.AttributeType.STRING },
                sortKey: { name: 'value', type: aws_dynamodb_1.AttributeType.NUMBER },
                projectionType: aws_dynamodb_1.ProjectionType.ALL,
            },
        ],
    });
};
exports.createMetricsTable = createMetricsTable;
function createVerificationCacheTable(stack) {
    return new dynamodb.Table(stack, 'VerificationCache', {
        partitionKey: { name: 'hash', type: dynamodb.AttributeType.STRING },
        billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
        timeToLiveAttribute: 'ttl',
        removalPolicy: cdk.RemovalPolicy.DESTROY,
    }).addGlobalSecondaryIndex({
        indexName: 'SimilarityIndex',
        partitionKey: { name: 'similarityKey', type: dynamodb.AttributeType.STRING },
        projectionType: dynamodb.ProjectionType.ALL,
    });
}
function createGoldenSetTable(stack) {
    return new dynamodb.Table(stack, 'GoldenSet', {
        partitionKey: { name: 'taskId', type: dynamodb.AttributeType.STRING },
        billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
        removalPolicy: cdk.RemovalPolicy.DESTROY,
    }).addGlobalSecondaryIndex({
        indexName: 'TaskTypeIndex',
        partitionKey: { name: 'taskType', type: dynamodb.AttributeType.STRING },
        projectionType: dynamodb.ProjectionType.ALL,
    });
}
function createWorkerActivitiesTable(stack) {
    return new dynamodb.Table(stack, 'WorkerActivities', {
        partitionKey: { name: 'workerId', type: dynamodb.AttributeType.STRING },
        sortKey: { name: 'timestamp', type: dynamodb.AttributeType.NUMBER },
        billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
        removalPolicy: cdk.RemovalPolicy.DESTROY,
        timeToLiveAttribute: 'ttl',
    }).addGlobalSecondaryIndex({
        indexName: 'TaskTypeIndex',
        partitionKey: { name: 'taskType', type: dynamodb.AttributeType.STRING },
        sortKey: { name: 'timestamp', type: dynamodb.AttributeType.NUMBER },
        projectionType: dynamodb.ProjectionType.ALL,
    });
}
function createWorkerMetricsTable(stack) {
    return new dynamodb.Table(stack, 'WorkerMetrics', {
        partitionKey: { name: 'workerId', type: dynamodb.AttributeType.STRING },
        billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
        removalPolicy: cdk.RemovalPolicy.DESTROY,
    })
        .addGlobalSecondaryIndex({
        indexName: 'ExpertiseIndex',
        partitionKey: { name: 'expertiseLevel', type: dynamodb.AttributeType.STRING },
        projectionType: dynamodb.ProjectionType.ALL,
    })
        .addGlobalSecondaryIndex({
        indexName: 'AccuracyIndex',
        partitionKey: { name: 'accuracyScore', type: dynamodb.AttributeType.NUMBER },
        projectionType: dynamodb.ProjectionType.ALL,
    });
}
function createConsolidatedResultsTable(stack) {
    return new dynamodb.Table(stack, 'ConsolidatedResults', {
        partitionKey: { name: 'taskId', type: dynamodb.AttributeType.STRING },
        billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
        removalPolicy: cdk.RemovalPolicy.DESTROY,
    })
        .addGlobalSecondaryIndex({
        indexName: 'StrategyIndex',
        partitionKey: { name: 'strategy', type: dynamodb.AttributeType.STRING },
        sortKey: { name: 'timestamp', type: dynamodb.AttributeType.NUMBER },
        projectionType: dynamodb.ProjectionType.ALL,
    })
        .addGlobalSecondaryIndex({
        indexName: 'DecisionIndex',
        partitionKey: { name: 'finalDecision', type: dynamodb.AttributeType.STRING },
        sortKey: { name: 'confidence', type: dynamodb.AttributeType.NUMBER },
        projectionType: dynamodb.ProjectionType.ALL,
    });
}
function createInsightsTable(stack) {
    return new dynamodb.Table(stack, 'Insights', {
        partitionKey: {
            name: 'timestamp',
            type: dynamodb.AttributeType.STRING,
        },
        billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
        removalPolicy: cdk.RemovalPolicy.DESTROY,
        timeToLiveAttribute: 'ttl',
        globalSecondaryIndexes: [
            {
                indexName: 'TypeIndex',
                partitionKey: {
                    name: 'insightType',
                    type: dynamodb.AttributeType.STRING,
                },
                sortKey: {
                    name: 'timestamp',
                    type: dynamodb.AttributeType.STRING,
                },
                projectionType: dynamodb.ProjectionType.ALL,
            },
        ],
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFibGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidGFibGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQStGQSxvRUFXQztBQUVELG9EQVVDO0FBRUQsa0VBYUM7QUFFRCw0REFnQkM7QUFFRCx3RUFrQkM7QUFFRCxrREF3QkM7QUFyTUQsMkRBTWtDO0FBQ2xDLG1DQUFtQztBQUNuQyxxREFBcUQ7QUFFOUMsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLEtBQVUsRUFBRSxFQUFVLEVBQUUsRUFBRTtJQUN6RCxPQUFPLElBQUksb0JBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxFQUFFO1FBQzFCLFNBQVMsRUFBRSxPQUFPO1FBQ2xCLFlBQVksRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLDRCQUFhLENBQUMsTUFBTSxFQUFFO1FBQzVELFdBQVcsRUFBRSwwQkFBVyxDQUFDLGVBQWU7UUFDeEMsTUFBTSxFQUFFLDZCQUFjLENBQUMsa0JBQWtCO1FBQ3pDLG1CQUFtQixFQUFFLFdBQVc7UUFFaEMsOEJBQThCO1FBQzlCLHNCQUFzQixFQUFFO1lBQ3RCO2dCQUNFLFNBQVMsRUFBRSxhQUFhO2dCQUN4QixZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSw0QkFBYSxDQUFDLE1BQU0sRUFBRTtnQkFDNUQsT0FBTyxFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUUsNEJBQWEsQ0FBQyxNQUFNLEVBQUU7Z0JBQzFELGNBQWMsRUFBRSw2QkFBYyxDQUFDLEdBQUc7YUFDbkM7WUFDRDtnQkFDRSxTQUFTLEVBQUUsV0FBVztnQkFDdEIsWUFBWSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsNEJBQWEsQ0FBQyxNQUFNLEVBQUU7Z0JBQzlELE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLDRCQUFhLENBQUMsTUFBTSxF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akIsSUFBSSxFQUFFLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTTtpQkFDcEM7Z0JBQ0QsY0FBYyxFQUFFLFFBQVEsQ0FBQyxjQUFjLENBQUMsR0FBRzthQUM1QztTQUNGO0tBQ0YsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEF0dHJpYnV0ZVR5cGUsXG4gIEJpbGxpbmdNb2RlLFxuICBQcm9qZWN0aW9uVHlwZSxcbiAgU3RyZWFtVmlld1R5cGUsXG4gIFRhYmxlLFxufSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZHluYW1vZGInO1xuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCAqIGFzIGR5bmFtb2RiIGZyb20gJ2F3cy1jZGstbGliL2F3cy1keW5hbW9kYic7XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVUYXNrc1RhYmxlID0gKHNjb3BlOiBhbnksIGlkOiBzdHJpbmcpID0+IHtcbiAgcmV0dXJuIG5ldyBUYWJsZShzY29wZSwgaWQsIHtcbiAgICB0YWJsZU5hbWU6ICdUYXNrcycsXG4gICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICd0YXNrSWQnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgIGJpbGxpbmdNb2RlOiBCaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gICAgc3RyZWFtOiBTdHJlYW1WaWV3VHlwZS5ORVdfQU5EX09MRF9JTUFHRVMsXG4gICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogJ2V4cGlyZXNBdCcsXG5cbiAgICAvLyBHU0lzIGZvciBlZmZpY2llbnQgcXVlcnlpbmdcbiAgICBnbG9iYWxTZWNvbmRhcnlJbmRleGVzOiBbXG4gICAgICB7XG4gICAgICAgIGluZGV4TmFtZTogJ1N0YXR1c0luZGV4JyxcbiAgICAgICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICdzdGF0dXMnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgICBzb3J0S2V5OiB7IG5hbWU6ICdjcmVhdGVkQXQnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgICBwcm9qZWN0aW9uVHlwZTogUHJvamVjdGlvblR5cGUuQUxMLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaW5kZXhOYW1lOiAnVHlwZUluZGV4JyxcbiAgICAgICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICd0YXNrVHlwZScsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICAgIHNvcnRLZXk6IHsgbmFtZTogJ3N0YXR1cycsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICAgIHByb2plY3Rpb25UeXBlOiBQcm9qZWN0aW9uVHlwZS5BTEwsXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVdvcmtlcnNUYWJsZSA9IChzY29wZTogYW55LCBpZDogc3RyaW5nKSA9PiB7XG4gIHJldHVybiBuZXcgVGFibGUoc2NvcGUsIGlkLCB7XG4gICAgdGFibGVOYW1lOiAnV29ya2VycycsXG4gICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICd3b3JrZXJJZCcsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcblxuICAgIGdsb2JhbFNlY29uZGFyeUluZGV4ZXM6IFtcbiAgICAgIHtcbiAgICAgICAgaW5kZXhOYW1lOiAnU3RhdHVzSW5kZXgnLFxuICAgICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ3N0YXR1cycsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICAgIHNvcnRLZXk6IHsgbmFtZTogJ2xhc3RBY3RpdmUnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgICBwcm9qZWN0aW9uVHlwZTogUHJvamVjdGlvblR5cGUuQUxMLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaW5kZXhOYW1lOiAnVGFza1R5cGVJbmRleCcsXG4gICAgICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAndGFza1R5cGUnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgICBzb3J0S2V5OiB7IG5hbWU6ICdyYXRpbmcnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLk5VTUJFUiB9LFxuICAgICAgICBwcm9qZWN0aW9uVHlwZTogUHJvamVjdGlvblR5cGUuQUxMLFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVSZXN1bHRzVGFibGUgPSAoc2NvcGU6IGFueSwgaWQ6IHN0cmluZykgPT4ge1xuICByZXR1cm4gbmV3IFRhYmxlKHNjb3BlLCBpZCwge1xuICAgIHRhYmxlTmFtZTogJ1Jlc3VsdHMnLFxuICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAndGFza0lkJywgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICBzb3J0S2V5OiB7IG5hbWU6ICd3b3JrZXJJZCcsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcblxuICAgIGdsb2JhbFNlY29uZGFyeUluZGV4ZXM6IFtcbiAgICAgIHtcbiAgICAgICAgaW5kZXhOYW1lOiAnV29ya2VySW5kZXgnLFxuICAgICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ3dvcmtlcklkJywgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgICAgc29ydEtleTogeyBuYW1lOiAnc3VibWl0dGVkQXQnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgICBwcm9qZWN0aW9uVHlwZTogUHJvamVjdGlvblR5cGUuQUxMLFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVNZXRyaWNzVGFibGUgPSAoc2NvcGU6IGFueSwgaWQ6IHN0cmluZykgPT4ge1xuICByZXR1cm4gbmV3IFRhYmxlKHNjb3BlLCBpZCwge1xuICAgIHRhYmxlTmFtZTogJ1dvcmtlck1ldHJpY3MnLFxuICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAnd29ya2VySWQnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgIHNvcnRLZXk6IHsgbmFtZTogJ21ldHJpY1R5cGUnLCB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgIGJpbGxpbmdNb2RlOiBCaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG5cbiAgICBnbG9iYWxTZWNvbmRhcnlJbmRleGVzOiBbXG4gICAgICB7XG4gICAgICAgIGluZGV4TmFtZTogJ01ldHJpY1R5cGVJbmRleCcsXG4gICAgICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAnbWV0cmljVHlwZScsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICAgIHNvcnRLZXk6IHsgbmFtZTogJ3ZhbHVlJywgdHlwZTogQXR0cmlidXRlVHlwZS5OVU1CRVIgfSxcbiAgICAgICAgcHJvamVjdGlvblR5cGU6IFByb2plY3Rpb25UeXBlLkFMTCxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVmVyaWZpY2F0aW9uQ2FjaGVUYWJsZShzdGFjazogY2RrLlN0YWNrKTogZHluYW1vZGIuVGFibGUge1xuICByZXR1cm4gbmV3IGR5bmFtb2RiLlRhYmxlKHN0YWNrLCAnVmVyaWZpY2F0aW9uQ2FjaGUnLCB7XG4gICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICdoYXNoJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICBiaWxsaW5nTW9kZTogZHluYW1vZGIuQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICAgIHRpbWVUb0xpdmVBdHRyaWJ1dGU6ICd0dGwnLFxuICAgIHJlbW92YWxQb2xpY3k6IGNkay5SZW1vdmFsUG9saWN5LkRFU1RST1ksXG4gIH0pLmFkZEdsb2JhbFNlY29uZGFyeUluZGV4KHtcbiAgICBpbmRleE5hbWU6ICdTaW1pbGFyaXR5SW5kZXgnLFxuICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAnc2ltaWxhcml0eUtleScsIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgcHJvamVjdGlvblR5cGU6IGR5bmFtb2RiLlByb2plY3Rpb25UeXBlLkFMTCxcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVHb2xkZW5TZXRUYWJsZShzdGFjazogY2RrLlN0YWNrKTogZHluYW1vZGIuVGFibGUge1xuICByZXR1cm4gbmV3IGR5bmFtb2RiLlRhYmxlKHN0YWNrLCAnR29sZGVuU2V0Jywge1xuICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAndGFza0lkJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICBiaWxsaW5nTW9kZTogZHluYW1vZGIuQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICAgIHJlbW92YWxQb2xpY3k6IGNkay5SZW1vdmFsUG9saWN5LkRFU1RST1ksXG4gIH0pLmFkZEdsb2JhbFNlY29uZGFyeUluZGV4KHtcbiAgICBpbmRleE5hbWU6ICdUYXNrVHlwZUluZGV4JyxcbiAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ3Rhc2tUeXBlJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICBwcm9qZWN0aW9uVHlwZTogZHluYW1vZGIuUHJvamVjdGlvblR5cGUuQUxMLFxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVdvcmtlckFjdGl2aXRpZXNUYWJsZShzdGFjazogY2RrLlN0YWNrKTogZHluYW1vZGIuVGFibGUge1xuICByZXR1cm4gbmV3IGR5bmFtb2RiLlRhYmxlKHN0YWNrLCAnV29ya2VyQWN0aXZpdGllcycsIHtcbiAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ3dvcmtlcklkJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICBzb3J0S2V5OiB7IG5hbWU6ICd0aW1lc3RhbXAnLCB0eXBlOiBkeW5hbW9kYi5BdHRyaWJ1dGVUeXBlLk5VTUJFUiB9LFxuICAgIGJpbGxpbmdNb2RlOiBkeW5hbW9kYi5CaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gICAgcmVtb3ZhbFBvbGljeTogY2RrLlJlbW92YWxQb2xpY3kuREVTVFJPWSxcbiAgICB0aW1lVG9MaXZlQXR0cmlidXRlOiAndHRsJyxcbiAgfSkuYWRkR2xvYmFsU2Vjb25kYXJ5SW5kZXgoe1xuICAgIGluZGV4TmFtZTogJ1Rhc2tUeXBlSW5kZXgnLFxuICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAndGFza1R5cGUnLCB0eXBlOiBkeW5hbW9kYi5BdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgIHNvcnRLZXk6IHsgbmFtZTogJ3RpbWVzdGFtcCcsIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuTlVNQkVSIH0sXG4gICAgcHJvamVjdGlvblR5cGU6IGR5bmFtb2RiLlByb2plY3Rpb25UeXBlLkFMTCxcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVXb3JrZXJNZXRyaWNzVGFibGUoc3RhY2s6IGNkay5TdGFjayk6IGR5bmFtb2RiLlRhYmxlIHtcbiAgcmV0dXJuIG5ldyBkeW5hbW9kYi5UYWJsZShzdGFjaywgJ1dvcmtlck1ldHJpY3MnLCB7XG4gICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICd3b3JrZXJJZCcsIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgYmlsbGluZ01vZGU6IGR5bmFtb2RiLkJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICByZW1vdmFsUG9saWN5OiBjZGsuUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxuICB9KVxuICAgIC5hZGRHbG9iYWxTZWNvbmRhcnlJbmRleCh7XG4gICAgICBpbmRleE5hbWU6ICdFeHBlcnRpc2VJbmRleCcsXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ2V4cGVydGlzZUxldmVsJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgIHByb2plY3Rpb25UeXBlOiBkeW5hbW9kYi5Qcm9qZWN0aW9uVHlwZS5BTEwsXG4gICAgfSlcbiAgICAuYWRkR2xvYmFsU2Vjb25kYXJ5SW5kZXgoe1xuICAgICAgaW5kZXhOYW1lOiAnQWNjdXJhY3lJbmRleCcsXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ2FjY3VyYWN5U2NvcmUnLCB0eXBlOiBkeW5hbW9kYi5BdHRyaWJ1dGVUeXBlLk5VTUJFUiB9LFxuICAgICAgcHJvamVjdGlvblR5cGU6IGR5bmFtb2RiLlByb2plY3Rpb25UeXBlLkFMTCxcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNvbnNvbGlkYXRlZFJlc3VsdHNUYWJsZShzdGFjazogY2RrLlN0YWNrKTogZHluYW1vZGIuVGFibGUge1xuICByZXR1cm4gbmV3IGR5bmFtb2RiLlRhYmxlKHN0YWNrLCAnQ29uc29saWRhdGVkUmVzdWx0cycsIHtcbiAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ3Rhc2tJZCcsIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgYmlsbGluZ01vZGU6IGR5bmFtb2RiLkJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICByZW1vdmFsUG9saWN5OiBjZGsuUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxuICB9KVxuICAgIC5hZGRHbG9iYWxTZWNvbmRhcnlJbmRleCh7XG4gICAgICBpbmRleE5hbWU6ICdTdHJhdGVneUluZGV4JyxcbiAgICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiAnc3RyYXRlZ3knLCB0eXBlOiBkeW5hbW9kYi5BdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgc29ydEtleTogeyBuYW1lOiAndGltZXN0YW1wJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5OVU1CRVIgfSxcbiAgICAgIHByb2plY3Rpb25UeXBlOiBkeW5hbW9kYi5Qcm9qZWN0aW9uVHlwZS5BTEwsXG4gICAgfSlcbiAgICAuYWRkR2xvYmFsU2Vjb25kYXJ5SW5kZXgoe1xuICAgICAgaW5kZXhOYW1lOiAnRGVjaXNpb25JbmRleCcsXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogJ2ZpbmFsRGVjaXNpb24nLCB0eXBlOiBkeW5hbW9kYi5BdHRyaWJ1dGVUeXBlLlNUUklORyB9LFxuICAgICAgc29ydEtleTogeyBuYW1lOiAnY29uZmlkZW5jZScsIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuTlVNQkVSIH0sXG4gICAgICBwcm9qZWN0aW9uVHlwZTogZHluYW1vZGIuUHJvamVjdGlvblR5cGUuQUxMLFxuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSW5zaWdodHNUYWJsZShzdGFjazogY2RrLlN0YWNrKTogZHluYW1vZGIuVGFibGUge1xuICByZXR1cm4gbmV3IGR5bmFtb2RiLlRhYmxlKHN0YWNrLCAnSW5zaWdodHMnLCB7XG4gICAgcGFydGl0aW9uS2V5OiB7XG4gICAgICBuYW1lOiAndGltZXN0YW1wJyxcbiAgICAgIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuU1RSSU5HLFxuICAgIH0sXG4gICAgYmlsbGluZ01vZGU6IGR5bmFtb2RiLkJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICByZW1vdmFsUG9saWN5OiBjZGsuUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxuICAgIHRpbWVUb0xpdmVBdHRyaWJ1dGU6ICd0dGwnLFxuICAgIGdsb2JhbFNlY29uZGFyeUluZGV4ZXM6IFtcbiAgICAgIHtcbiAgICAgICAgaW5kZXhOYW1lOiAnVHlwZUluZGV4JyxcbiAgICAgICAgcGFydGl0aW9uS2V5OiB7XG4gICAgICAgICAgbmFtZTogJ2luc2lnaHRUeXBlJyxcbiAgICAgICAgICB0eXBlOiBkeW5hbW9kYi5BdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgICAgICAgfSxcbiAgICAgICAgc29ydEtleToge1xuICAgICAgICAgIG5hbWU6ICd0aW1lc3RhbXAnLFxuICAgICAgICAgIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuU1RSSU5HLFxuICAgICAgICB9LFxuICAgICAgICBwcm9qZWN0aW9uVHlwZTogZHluYW1vZGIuUHJvamVjdGlvblR5cGUuQUxMLFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcbn1cbiJdfQ==